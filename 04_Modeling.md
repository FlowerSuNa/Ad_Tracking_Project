##### TalkingData AdTracking Fraud Detection Challenge
# 4. Modeling
[source code](04_Modeling_Logistic.py)

<br>

---

## Train Size : 20,000,000

| Dataset | Not Downloaded | Downloaded | Total |
|:-------:|---------------:|-----------:|------:|
| Train | 15,962,214 | 37,786 | 16,000,000
| Valid | 3,990,607 | 9,393 | 4,000,000 |

<br>

#### Used Features : black_ip, black_app, black_os, black_channel

Score

| Model | Parameter | value | Train AUC | Valid AUC | Score |
|:-----:|:---------:|:-----:|:---------:|:---------:|:-----:|
| Logistic Regression | C | 0.01 | 0.91760 | 0.91851 | - |
|  |  | 0.1 | 0.91760 | 0.91851 | - |
|  |  | 1 | 0.91760 | 0.91851 | - |
|  |  | 10 | 0.91760 | 0.91851 | - |
|  |  | 100 | 0.91760 | 0.91851 | 0.9050371 |
| Decision Tree | max_depth | 1 | 0.83560 | 0.83797 | - |
|  |  | 2 | 0.89017 | 0.89141 | - |
|  |  | 3 | 0.91725 | 0.91811 | - |
|  |  | 4 | 0.91823 | 0.91906 | - |
|  |  | 5 | 0.91823 | 0.91906 | 0.9056274 |
| LightGBM | skip | - | 0.91823 | 0.91906 | 0.9056274 |

<br>

Coefficient

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Logistic Regression | C | 0.01 | -3.06639 | -3.62914 | 0.35751 | -1.86023 |
|  |  | 0.1 | -3.12880 | -3.72217 | 0.43949 | -1.86185 |
|  |  | 1 | -3.13530 | -3.73185 | 0.44802 | -1.86196 |
|  |  | 10 | -3.13585 | -3.73261 | 0.44865 | -1.86179|
|  |  | 100 | -3.13592 | -3.73270 | 0.44874 | -1.86179 |

<br>

Feature Importance

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Decision Tree | max_depth | 1 | 0 | 1 | 0 | 0 |
|  |  | 2 | 0.57799 | 0.42201 | 0 | 0 |
|  |  | 3 | 0.49437 | 0.36096 | 0.04157 | 0.10901 |
|  |  | 4 | 0.48144 | 0.35151 | 0.06401 | 0.10303 |
|  |  | 5 | 0.48144 | 0.35151 | 0.06401 | 0.10303 |
| LightGBM | skip | - | 0.13975 | 0.55410 | 0.03579 | 0.27036 |

<br>

#### Used Features : black_ip, gap_app, black_app, gap_os, black_os, gap_channel, black_channel

Score

| Model | Parameter | value | Train AUC | Valid AUC | Score |
|:-----:|:---------:|:-----:|:---------:|:---------:|:-----:|
| Logistic Regression | C | 0.1 | 0.90897 | 0.90805 | - |
|  |  | 1 | 0.90897 | 0.90805 | 0.9003460 |
|  |  | 10 | 0.90897 | 0.90805 | - |
| Decision Tree | max_depth | 3 | 0.93339  | 0.93385 | - |
|  |  | 4 | 0.93505 | 0.93548 | - |
|  |  | 5 | 0.94870 | 0.94847 | - |
|  |  | 6 | 0.95446 | 0.95382 | - |
|  |  | 7 | 0.95878 | 0.95779 | 0.9455029 |
| LightGBM | skip | - | 0.97367 | 0.97143 | - |

<br>

Coefficient

| Model | Parameter | value | black_ip | gap_app | black_app | gap_os | black_os | gap_channel | black_channel |
|:-----:|:---------:|:-----:|:--------:|:-------:|:---------:|:------:|:--------:|:-----------:|:-------------:|
| Logistic Regression | C | 0.1 | -1.06494834e-11 | -3.95847172e-07 | -9.31501883e-12 | -7.60239423e-08 | -8.53923308e-12 | -2.20993191e-06 | -5.93182256e-12 |
|  |  | 1 | -1.06494834e-11 | -3.95847172e-07 | -9.31501883e-12 | -7.60239423e-08 | -8.53923308e-12 | -2.20993191e-06 | -5.93182256e-12 |
|  |  | 10 | -1.06494834e-11 | -3.95847172e-07 | -9.31501883e-12 | -7.60239423e-08 | -8.53923308e-12 | -2.20993191e-06 | -5.93182256e-12 |

<br>

Feature Importance

| Model | Parameter | value | black_ip | gap_app | black_app | gap_os | black_os | gap_channel | black_channel |
|:-----:|:---------:|:-----:|:--------:|:-------:|:---------:|:------:|:--------:|:-----------:|:-------------:|
| Decision Tree | max_depth | 3 | 0.45970 | 0.20465 | 0.33564 | 0 | 0 | 0| 0 |
|  |  | 4 | 0.41370 | 0.26571 | 0.30206 | 0 | 0 | 0.00248 | 0.01605 |
|  |  | 5 | 0.38732 | 0.27541 | 0.28280 | 0.00703 | 0 | 0.02476 | 0.02267 |
|  |  | 6 | 0.37239 | 0.26694 | 0.27189 | 0.02149 | 0.00563 | 0.03721 | 0.02445 |
|  |  | 7 | 0.36299 | 0.26704 | 0.26503 | 0.02663 | 0.00899 | 0.04477 | 0.00245 |
| LightGBM | skip | - | 0.07101 | 0.62613 | 0.2255 | 0.02153 | 0.00099 | 0.03133 |

<br>

#### Used Features : black_ip, gap_app, black_app, gap_device, gap_os, black_os, gap_channel, black_channel, black_hour


<br>

---

## Train Size : 50,000,000

| Dataset | Not Downloaded | Downloaded | Total |
|:-------:|---------------:|-----------:|------:|
| Train | 39,897,655 | 102,345 | 40,000,000
| Valid | 9,974,300 | 25,700 | 10,000,000 |

<br>

#### Features : black_ip, black_app, black_os, black_channel

Score

| Model | Parameter | value | Train AUC | Valid AUC | Score |
|:-----:|:---------:|:-----:|:---------:|:---------:|:-----:|
| Logistic Regression | C | 0.01 | 0.90328 | 0.90267 | - |
|  |  | 0.1 | 0.90328 | 0.90267 | - |
|  |  | 1 | 0.90328 | 0.90267 | - |
|  |  | 10 | 0.90328 | 0.90267 | - |
|  |  | 100 | 0.90328 | 0.90267 | - |
| Decision Tree | max_depth | 1 | 0.81339 | 0.81355 | - |
|  |  | 2 | 0.87284 | 0.87284 | - |
|  |  | 3 | 0.90275 | 0.90213 | - |
|  |  | 4 | 0.90379 | 0.90315 | - |
|  |  | 5 | 0.90379 | 0.90315 | - |
| LightGBM | skip |  | 0.90242 | 0.90179 | - |

<br>

Coefficient

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Logistic Regression | C | 0.01 | -3.14269 | -3.56713 | 0.63704 | -2.23556 |
|  |  | 0.1 | -3.17682 | -3.60232 | 0.66978 | -2.23772 |
|  |  | 1 | -3.17648 | -3.60590 | 0.67311 | -2.23793 |
|  |  | 10 | -3.17679 | -3.60626 | 0.67344 | -2.23795 |
|  |  | 100 | -3.17682 | -3.60630 | 0.67348 | -2.23795 |

<br>

Feature Importance

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Decision Tree | max_depth | 1 | 0 | 1 | 0 | 0 |
|  |  | 2 | 0.55493 | 0.44507 | 0 | 0 |
|  |  | 3 | 0.44407 | 0.35616 | 0.04243 | 0.15734 |
|  |  | 4 | 0.42282 | 0.33912 | 0.08467 | 0.15338 |
|  |  | 5 | 0.42282 | 0.33912 | 0.08467 | 0.15338 |
| LightGBM | skip |  | 0.41667 | 0.25 | 0.25 | 0.08333 |

<br>

---

Score

| Model | Parameter | value | Train AUC | Valid AUC | Score |
|:-----:|:---------:|:-----:|:---------:|:---------:|:-----:|
| Logistic Regression | C | 0.1 |  |  | - |
|  |  | 1 |  |  | - |
|  |  | 10 |  |  | - |
| Decision Tree | max_depth | 1 |  |  | - |
|  |  | 2 |  |  | - |
|  |  | 3 |  |  | - |
|  |  | 4 |  |  | - |
|  |  | 5 |  |  |  |
| LightGBM | skip |  |  |  | - |

<br>

Coefficient

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Logistic Regression | C | 0.1 |  |  |  |  |
|  |  | 1 |  |  |  |  |
|  |  | 10 |  |  |  |  |

<br>

Feature Importance

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Decision Tree | max_depth | 1 |  |  |  |  |
|  |  | 2 |  |  |  |  |
|  |  | 3 |  |  |  |  |
|  |  | 4 |  |  |  |  |
|  |  | 5 |  |  |  |  |
| LightGBM | skip |  |  |  |  |  |

<br>



Score

| Model | Parameter | value | Train AUC | Valid AUC | Score |
|:-----:|:---------:|:-----:|:---------:|:---------:|:-----:|
| Random Forest | max_depth | 1 , 50 , 1 | 0.91537 | 0.91619 | - |
|  | n_estimators | 1 , 50 , 2 | 0.89226 | 0.89290 | - |
|  | max_features | 1 , 50 , 3 | 0.89017 | 0.89141 | - |
|  |  | 1 , 50 , 4 | 0.83560 | 0.89797 | - |
|  |  | 1 , 70 , 1 | 0.91537 | 0.91619 | - |
|  |  | 1 , 70 , 2 | 0.89226 | 0.89290 | - |
|  |  | 1 , 70 , 3 | 0.89017 | 0.89141 | - |
|  |  | 1 , 70 , 4 | 0.83560 | 0.83797 | - |
|  |  | 1 , 100 , 1 |  |  | - |
|  |  | 1 , 100 , 2 |  |  | - |
|  |  | 1 , 100 , 3 |  |  | - |
|  |  | 1 , 100 , 4 |  |  | - |
|  |  | 2 , 50 , 1 |  |  | - |
|  |  | 2 , 50 , 2 |  |  | - |
|  |  | 2 , 50 , 3 |  |  | - |
|  |  | 2 , 50 , 4 |  |  | - |
|  |  | 2 , 70 , 1 |  |  | - |
|  |  | 2 , 70 , 2 |  |  | - |
|  |  | 2 , 70 , 3 |  |  | - |
|  |  | 2 , 70 , 4 |  |  | - |
|  |  | 2 , 100 , 1 |  |  | - |
|  |  | 2 , 100 , 2 |  |  | - |
|  |  | 2 , 100 , 3 |  |  | - |
|  |  | 2 , 100 , 4 |  |  | - |
|  |  | 3 , 50 , 1 |  |  | - |
|  |  | 3 , 50 , 2 |  |  | - |
|  |  | 3 , 50 , 3 |  |  | - |
|  |  | 3 , 50 , 4 |  |  | - |
|  |  | 3 , 70 , 1 |  |  | - |
|  |  | 3 , 70 , 2 |  |  | - |
|  |  | 3 , 70 , 3 |  |  | - |
|  |  | 3 , 70 , 4 |  |  | - |
|  |  | 3 , 100 , 1 |  |  | - |
|  |  | 3 , 100 , 2 |  |  | - |
|  |  | 3 , 100 , 3 |  |  | - |
|  |  | 3 , 100 , 4 |  |  | - |
|  |  | 4 , 50 , 1 |  |  | - |
|  |  | 4 , 50 , 2 |  |  | - |
|  |  | 4 , 50 , 3 |  |  | - |
|  |  | 4 , 50 , 4 |  |  | - |
|  |  | 4 , 70 , 1 |  |  | - |
|  |  | 4 , 70 , 2 |  |  | - |
|  |  | 4 , 70 , 3 |  |  | - |
|  |  | 4 , 70 , 4 |  |  | - |
|  |  | 4 , 100 , 1 |  |  | - |
|  |  | 4 , 100 , 2 |  |  | - |
|  |  | 4 , 100 , 3 |  |  | - |
|  |  | 4 , 100 , 4 |  |  | - |
|  |  | 5 , 50 , 1 |  |  | - |
|  |  | 5 , 50 , 2 |  |  | - |
|  |  | 5 , 50 , 3 |  |  | - |
|  |  | 5 , 50 , 4 |  |  | - |
|  |  | 5 , 70 , 1 |  |  | - |
|  |  | 5 , 70 , 2 |  |  | - |
|  |  | 5 , 70 , 3 |  |  | - |
|  |  | 5 , 70 , 4 |  |  | - |
|  |  | 5 , 100 , 1 |  |  | - |
|  |  | 5 , 100 , 2 |  |  | - |
|  |  | 5 , 100 , 3 |  |  | - |
|  |  | 5 , 100 , 4 |  |  | - |




Feature Importance

| Model | Parameter | value | black_ip | black_app | black_os | black_channel |
|:-----:|:---------:|:-----:|:--------:|:---------:|:--------:|:-------------:|
| Random Forest | max_depth | 1 , 50 , 1 | 0.24 | 0.22 | 0.24 | 0.3 |
|  | n_estimators | 1 , 50 , 2 | 0.36 | 0.38 | 0.26 | 0 |
|  | max_features | 1 , 50 , 3 | 0.26 | 0.74 | 0 | 0 |
|  |  | 1 , 50 , 4 | 0 | 1 | 0 | 0|
|  |  | 1 , 70 , 1 | 0.25714 | 0.18571 | 0.27143 | 0.28571 |
|  |  | 1 , 70 , 2 | 0.45714 | 0.4 | 0.14286 | 0 |
|  |  | 1 , 70 , 3 | 0.25714 | 0.74286 | 0 | 0 |
|  |  | 1 , 70 , 4 | 0 | 1 | 0 | 0 |
|  |  | 1 , 100 , 1 |  |  | - |
|  |  | 1 , 100 , 2 |  |  | - |
|  |  | 1 , 100 , 3 |  |  | - |
|  |  | 1 , 100 , 4 |  |  | - |
|  |  | 2 , 50 , 1 |  |  | - |
|  |  | 2 , 50 , 2 |  |  | - |
|  |  | 2 , 50 , 3 |  |  | - |
|  |  | 2 , 50 , 4 |  |  | - |
|  |  | 2 , 70 , 1 |  |  | - |
|  |  | 2 , 70 , 2 |  |  | - |
|  |  | 2 , 70 , 3 |  |  | - |
|  |  | 2 , 70 , 4 |  |  | - |
|  |  | 2 , 100 , 1 |  |  | - |
|  |  | 2 , 100 , 2 |  |  | - |
|  |  | 2 , 100 , 3 |  |  | - |
|  |  | 2 , 100 , 4 |  |  | - |
|  |  | 3 , 50 , 1 |  |  | - |
|  |  | 3 , 50 , 2 |  |  | - |
|  |  | 3 , 50 , 3 |  |  | - |
|  |  | 3 , 50 , 4 |  |  | - |
|  |  | 3 , 70 , 1 |  |  | - |
|  |  | 3 , 70 , 2 |  |  | - |
|  |  | 3 , 70 , 3 |  |  | - |
|  |  | 3 , 70 , 4 |  |  | - |
|  |  | 3 , 100 , 1 |  |  | - |
|  |  | 3 , 100 , 2 |  |  | - |
|  |  | 3 , 100 , 3 |  |  | - |
|  |  | 3 , 100 , 4 |  |  | - |
|  |  | 4 , 50 , 1 |  |  | - |
|  |  | 4 , 50 , 2 |  |  | - |
|  |  | 4 , 50 , 3 |  |  | - |
|  |  | 4 , 50 , 4 |  |  | - |
|  |  | 4 , 70 , 1 |  |  | - |
|  |  | 4 , 70 , 2 |  |  | - |
|  |  | 4 , 70 , 3 |  |  | - |
|  |  | 4 , 70 , 4 |  |  | - |
|  |  | 4 , 100 , 1 |  |  | - |
|  |  | 4 , 100 , 2 |  |  | - |
|  |  | 4 , 100 , 3 |  |  | - |
|  |  | 4 , 100 , 4 |  |  | - |
|  |  | 5 , 50 , 1 |  |  | - |
|  |  | 5 , 50 , 2 |  |  | - |
|  |  | 5 , 50 , 3 |  |  | - |
|  |  | 5 , 50 , 4 |  |  | - |
|  |  | 5 , 70 , 1 |  |  | - |
|  |  | 5 , 70 , 2 |  |  | - |
|  |  | 5 , 70 , 3 |  |  | - |
|  |  | 5 , 70 , 4 |  |  | - |
|  |  | 5 , 100 , 1 |  |  | - |
|  |  | 5 , 100 , 2 |  |  | - |
|  |  | 5 , 100 , 3 |  |  | - |
|  |  | 5 , 100 , 4 |  |  | - |
